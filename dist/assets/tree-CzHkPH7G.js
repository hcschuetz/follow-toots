import"./nav-Dzs_oev3.js";import{t as e}from"./database-BGZyZyq9.js";import{a as t,d as n,f as r,i,l as a,n as o,r as s,s as c,t as l,u}from"./formatDate-Dyo-rJ98.js";import{a as d,i as f,n as p,o as m,r as h,t as ee}from"./signals-core.module-PplyFw7G.js";import{n as te,r as ne,t as re}from"./linkConfigConfig-YtmXU9nm.js";var g=(e,t,...n)=>h(`a`,{href:t,target:`_blank`,rel:`noopener noreferrer`},t=>e.split(/[ \.]/).forEach(e=>e&&t.classList.add(e)),...n),ie={},_=(e={})=>({keep:!0,attributes:new Map(Object.entries({...ie,...e}))}),ae=new Map(Object.entries({DIV:_(),SPAN:_({translate:!1,class:!0}),P:_(),BR:_(),I:_(),B:_(),U:_(),STRONG:_(),EM:_(),UL:_(),OL:_(),LI:_(),CODE:_(),PRE:_()}));function*oe(e,t){for(let n of e.attributes)switch(t.get(n.name)){case void 0:console.warn(`skipping attribute`,n);break;case!0:yield n;break;case!1:break}}function*v(e){for(let t of e)if(t instanceof Text)yield t.textContent;else if(t instanceof HTMLAnchorElement)yield g(``,t.href,v(t.childNodes));else if(t instanceof HTMLElement){let e=ae.get(t.tagName);switch(e?.keep){case void 0:console.warn(`unknown element`,t),yield*v(t.childNodes);break;case!0:yield f(t.tagName,oe(t,e.attributes),v(t.childNodes));break;case!1:break}}else console.warn(`skipping node`,t)}var se=new DOMParser;function*ce(e){try{yield*v(se.parseFromString(e,`text/html`).body.childNodes)}catch{yield h(`div.sanitization-error`,`[Error sanitizing "${e}"`)}}var le=`.context-menu {\r
  position: fixed;\r
  width: max-content;\r
  z-index: 1000;\r
  display: none;\r
  list-style: none;\r
  border-radius: 3px;\r
  border: 1px solid #444;\r
  padding: 2px;\r
  background-color: #ccc;\r
  &.open {\r
    display: flex;\r
    flex-direction: column;\r
    gap: 2px;\r
  }\r
}\r
`,ue=new CSSStyleSheet;ue.replaceSync(le);var de=class e extends HTMLElement{static current;open;close;itemProvider;constructor(){super();let t=this.attachShadow({mode:`open`});t.adoptedStyleSheets.push(ue);let n=h(`div.context-menu`,h(`slot`));n.setAttribute(`tabindex`,`0`),t.append(n),this.open=t=>{t.ctrlKey&&(e.current?.close(),e.current=this,d(this,this.itemProvider?.()),t.preventDefault(),n.classList.add(`open`),r(n.style,{left:(t.clientX+n.offsetWidth<=window.innerWidth?t.clientX:t.clientX>=n.offsetWidth?t.clientX-n.offsetWidth:Math.max(0,window.innerWidth-n.offsetWidth))+`px`,top:(t.clientY+n.offsetHeight<=window.innerHeight?t.clientY:t.clientY>=n.offsetHeight?t.clientY-n.offsetHeight:Math.max(0,window.innerHeight-n.offsetHeight))+`px`}),n.focus(),n.onkeydown=e=>{e.key===`Escape`&&this.close()},document.addEventListener(`click`,this.close))},this.close=()=>{e.current=void 0,this.replaceChildren(),n.classList.remove(`open`),document.removeEventListener(`click`,this.close),document.removeEventListener(`contextmenu`,this.close)}}connectedCallback(){this.parentElement.addEventListener(`contextmenu`,this.open)}disconnectedCallback(){this.close(),this.parentElement.removeEventListener(`contextmenu`,this.open)}};window.customElements.define(`context-menu`,de);var fe=`.menu {\r
  position: relative;\r
  display: inline-block;\r
  > summary {\r
    padding-inline: 3px;\r
    border-radius: 3px;\r
    cursor: default;\r
    &::marker {\r
      content: "";\r
    }\r
    &:hover {\r
      background-color: #0003;\r
    }\r
  }\r
  &:open::details-content {\r
    position: absolute;\r
    top: 100%;\r
    z-index: 1;\r
\r
    border: 1px solid #444;\r
    border-radius: 3px;\r
    padding: 2px;\r
    width: max-content;\r
    background-color: #ccc;\r
\r
    display: flex;\r
    flex-direction: column;\r
    gap: 2px;\r
  }\r
}\r
`,y=new CSSStyleSheet;y.replaceSync(fe);var b=class extends HTMLElement{close;itemProvider;constructor(){super();let e=h(`details.menu`,{onkeydown:t=>{t.key===`Escape`&&(e.open=!1)},ontoggle:()=>this.itemProvider&&d(this,e.open?this.itemProvider?.():null)},h(`summary`,`☰`),h(`slot`)),t=this.attachShadow({mode:`open`});t.adoptedStyleSheets.push(y),t.append(e),this.close=t=>{e.open&&(e.open=!1,t.preventDefault())}}connectedCallback(){document.addEventListener(`click`,this.close)}disconnectedCallback(){document.removeEventListener(`click`,this.close)}};window.customElements.define(`drop-down-menu`,b);var pe=`modulepreload`,me=function(e,t){return new URL(e,t).href},x={};const he=function(e,t,n){let r=Promise.resolve();if(t&&t.length>0){let e=document.getElementsByTagName(`link`),i=document.querySelector(`meta[property=csp-nonce]`),a=i?.nonce||i?.getAttribute(`nonce`);function o(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:`fulfilled`,value:e}),e=>({status:`rejected`,reason:e}))))}r=o(t.map(t=>{if(t=me(t,n),t in x)return;x[t]=!0;let r=t.endsWith(`.css`),i=r?`[rel="stylesheet"]`:``;if(n)for(let n=e.length-1;n>=0;n--){let i=e[n];if(i.href===t&&(!r||i.rel===`stylesheet`))return}else if(document.querySelector(`link[href="${t}"]${i}`))return;let o=document.createElement(`link`);if(o.rel=r?`stylesheet`:pe,r||(o.as=`script`),o.crossOrigin=``,o.href=t,a&&o.setAttribute(`nonce`,a),document.head.appendChild(o),r)return new Promise((e,n)=>{o.addEventListener(`load`,e),o.addEventListener(`error`,()=>n(Error(`Unable to preload CSS for ${t}`)))})}))}function i(e){let t=new Event(`vite:preloadError`,{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then(t=>{for(let e of t||[])e.status===`rejected`&&i(e.reason);return e().catch(i)})};var S=`https://cdn.jsdelivr.net/npm/katex@0.16.28/dist/`,C;function ge(){if(!C){C=new CSSStyleSheet;let e=S+`katex.min.css`;(async()=>{try{await C.replace(await(await fetch(e)).text())}catch(e){console.error(e),alert(`Exception while getting/applying KaTeX stylesheet:
`+e)}})(),document.head.appendChild(h(`link`,{rel:`stylesheet`,href:e}))}return C}async function _e(e){try{let t=(await he(async()=>{let{default:e}=await import(S+`contrib/auto-render.min.mjs`);return{default:e}},[],import.meta.url)).default,n=T(e);t(n);let r=be(n);e.replaceChildren(...r.childNodes)}catch(e){console.error(e),alert(`LaTeX rendering failed:
`+e)}}var ve=/\$\$(?:.|\n)+\$\$|\$[^$]+\$|\\\((?:.|\n)+\\\)|\\\[(?:.|\n)+\\\]/;function w(e){let t=e=>[...e.childNodes].some(e=>e instanceof Text&&ve.test(e.data)||e instanceof Element&&w(e)),n=T(e);return n.normalize(),t(n)}const ye=()=>h(`span`,{style:`
      font-family: Times New Roman, serif;
    `},`L`,h(`span`,{style:`
      font-size: 0.85em;
      vertical-align: 0.15em;
      margin-left: -0.36em;
      margin-right: -0.15em;    
    `},`A`),`T`,h(`span`,{style:`
      vertical-align: -0.5ex;
      margin-left: -0.1667em;
      margin-right: -0.125em;    
    `},`E`),`X`);function T(e){let t=e.cloneNode();return t.append(...[...e.childNodes].map(e=>e instanceof HTMLBRElement?`
`:e instanceof Element?T(e):e instanceof Text?e.data:``)),t}function be(e){let t=e.cloneNode();return t.append(...[...e.childNodes].flatMap(e=>e instanceof Text?e.data.split(`
`).flatMap((e,t)=>t==0?[e]:[h(`br`),e]):e instanceof Element?[be(e)]:[])),t}var xe=`.toot-content {\r
  white-space: pre-wrap;\r
}\r
\r
p {\r
  margin-block: 0.3em;\r
  &:first-child {\r
    margin-top: 0;\r
  }\r
  &:last-child {\r
    margin-bottom: 0;\r
  }\r
}\r
\r
/* TODO make these hacks configurable?: */\r
span.ellipsis::after {\r
  content: "...";\r
}\r
span.invisible {\r
  display: inline-block;\r
  width: 0;\r
  text-wrap-mode: nowrap;\r
  overflow-x: hidden;\r
}\r
\r
.custom-emoji {\r
  position: relative;\r
  bottom: -0.12lh;\r
  height: .7lh;\r
}\r
`,E=[[`reblogs_count`,`B`,`boost`,`boosts`],[`favourites_count`,`F`,`favourite`,`favourites`],[`quotes_count`,`Q`,`quote`,`quotes`],[`replies_count`,`R`,`reply`,`replies`]].map(([e,t,n,r])=>({prop:e,abbr:t,singular:n,plural:r}));function Se(e){if(E.every(({prop:t})=>e[t]===0))return null;let t=E.filter(({prop:t})=>e[t]!==0).map(({prop:t,abbr:n})=>`${e[t]}${n}`).join(`/`);return h(`span.toot-stats`,{title:E.map(({prop:t,singular:n,plural:r})=>{let i=e[t];return`${i} ${i===1?n:r}`}).join(`, `)},`[${t}]`)}var D=new CSSStyleSheet;D.replace(xe);var O=class extends HTMLElement{#e=h(`span.contents.prefix`);#t=h(`input.seen`,{type:`checkbox`,onchange:()=>this.seen=this.seen,title:`Mark toot as seen/unseen`});#n;#r=new b;#i=new de;set headerPrefix(e){d(this.#e,e)}get seen(){return this.#t.checked}set seen(e){this.#t.checked=e,this.onseenchange?.(new CustomEvent(`seenchanged`,{detail:this.seen}))}onseenchange;set dropDownMenuItemProvider(e){this.#r.itemProvider=()=>[e(this.#n,this)]}set contextMenuItemProvider(e){this.#i.itemProvider=()=>[e(this.#n,this)]}constructor(e){super(),this.#n=e;let{account:t,poll:n,card:r}=e,i=h(`span.contents`);d(this,{className:`toot visibility-${e.visibility}`,tabIndex:0},this.#i,h(`div.toot-head`,this.#e,this.#t,this.#r,h(`img.toot-author-avatar`,{src:t.avatar_static}),h(`span.toot-author`,s(t.display_name,t.emojis)),h(`span.toot-acct`,`@`+t.acct),h(`span.fill`,i,h(`span.visibility`,e.visibility),Se(e),e.edited_at?[h(`span.toot-created.line-through`,l(e.created_at)),h(`span.toot-edited`,l(e.edited_at))]:h(`span.toot-created`,l(e.created_at)))),()=>{let t=h(`div.toot-content`,ce(e.content),o(e.emojis)),a=h(`div.toot-content-host`),s=a.attachShadow({mode:`open`});s.adoptedStyleSheets.push(D),s.getRootNode().appendChild(t);let c=h(`div.toot-body`,a,e.media_attachments?.length?()=>{let t=h(`ul.attachments`,e.media_attachments.map(e=>h(`li.attachment`,h(`img.preview`,{src:e.preview_url,alt:e.description??``,title:e.description??``}),e.url&&g(`media-link`,e.url,`→ ${e.type}`))));return e.sensitive?h(`details.sensitive`,h(`summary`),t):t}:void 0,n&&h(`div.poll`,h(`ul.poll`,n.options.map((e,t)=>h(`li.poll-option`,h(`span.poll-option-title`,(n.own_votes??[]).includes(t)?n.multiple?`☑`:`⦿︎`:n.multiple?`☐`:`⚪︎`,` `,e.title),h(`span.poll-option-votes`,e.votes_count?.toString(),`/`,n.voters_count?.toString())))),n.voters_count===n.votes_count?null:h(`div.poll-votes-count`,`total votes: `,n.votes_count.toString()),h(`div.poll-expiry`,e=>e.classList.add(n.expired?`poll-expired`:`poll-ongoing`),n.expires_at&&l(n.expires_at))),r&&h(`div.card`,r.image?h(`img.card-image`,{src:r.image,alt:r.image_description??``,title:r.image_description??``,width:r.width??void 0,height:r.height??void 0}):void 0,function*(){r.provider_name&&(yield r.provider_url?g(`card-provider`,r.provider_url,r.provider_name):r.provider_name),yield g(`card-title`,r.url,r.title);let e=(r.authors??[]).filter(e=>e.name);switch(e.length){case 0:r.author_name&&(yield h(`span`,`by `,r.author_url?g(`card-author`,r.author_url,r.author_name):r.author_name));break;case 1:{let{name:t,url:n}=e[0];yield h(`span`,`by `,g(`card-author`,n,t));break}default:yield`by`,yield h(`ul.card-authors`,function*(){for(let{name:t,url:n}of e)yield h(`li`,g(`card-author`,n,t))});break}r.description&&h(`div.card-description`,r.description)}));if(w(t)){let e;m(i,h(`label`,ye(),h(`input`,n=>({type:`checkbox`,onkeydown:e=>{e.key===` `&&e.stopPropagation()},onchange:r=>{if(r.stopImmediatePropagation(),r.preventDefault(),n.checked){e=t.cloneNode(!0),_e(t);let{adoptedStyleSheets:n}=a.shadowRoot,r=ge();n.includes(r)||n.push(r)}else d(t,e.childNodes)}}))))}return e.spoiler_text&&(c=h(`details`,h(`summary`,e.spoiler_text),c)),c.classList.add(`toot-full-body`),c})}};window.customElements.define(`rendered-toot`,O);function k(e,t,n){let r=e instanceof Array?e:[...e],i=r.length,a=r.findIndex(e=>e===t),o=a;do{o=(o+1)%i;let e=r[o];if(n(e))return e}while(o!==a)}function Ce(e,t,n){return k([...e].reverse(),t,n)}var we=class{disposers=[];register(e){this.disposers.push(e)}disposeAll(){for(let e of this.disposers)e();this.disposers.length=0}};const A=(e,t,n)=>h(`button.menu-entry-with-key-hint`,h(`span`,e),h(`span`,t.map((e,t)=>[t===0?null:` + `,h(`span.keyboard`,e)])),{onclick:n});var Te=new we;function j(e){Te.register(ee(e))}var M=await e,N=new URLSearchParams(location.hash.substring(1));try{let e=N.get(`url`);if(e){let[t,n]=i(e)??Ee();N.delete(`url`),N.set(`instance`,t),N.set(`id`,n),window.history.replaceState({},``,`#`+N),await M.get(`treeOverview`,`${t}/${n}`)||c(t,n)}}catch(e){alert(`something went wrong when adapting the hash: ${e}`)}function Ee(){throw window.close(),alert(`Could not close this window automatically.  Please close it manually.`),`Window was closed neither automatically nor manually.`}var P=N.get(`instance`),F=N.get(`id`),I=`${P}/${F}`;n(`followToots`,{async updatedTreeOverview(e){e===I&&$(!1)},async updatedTree(e){e===I&&$(!0)},async deletedTree(e){e===I&&$(!0)},cleared(){$(!0)}});var L,R,z=[],B=new Map;async function De(){L&&a({...L,seenIds:new Set})}async function Oe(){L&&R&&a({...L,seenIds:new Set(z.map(e=>u(e)))})}var V=p(void 0,{name:`linkConfig`});async function H(){V.value=(await M.get(`config`,`links`)).value}new BroadcastChannel(`linkConfig`).addEventListener(`message`,H),H();var U=new Map,W=[];function G(e,t){W.push(e);let n=U.get(e);return n.headerPrefix=t,n}function K(e){if(!e)return;let t=U.get(e);t&&(t.focus({preventScroll:!0}),t.scrollIntoView({block:`center`,behavior:`smooth`}))}function q(e){let t=W.findIndex(t=>t===e);t<0||K(W[(t+1)%W.length])}function ke(e){let t=W.length,n=W.findIndex(t=>t===e);n<0||K(W[(n-1+t)%t])}function Ae(e){K(k(W,e,e=>!B.get(u(e))?.value))}function je(e){K(Ce(W,e,e=>!B.get(u(e))?.value))}var Me=(e,t)=>{let n=B.get(u(e)),r=n.value,i=V.value;return[A(r?`☐ Mark toot as unseen`:`☑ Mark toot as seen`,[`Space`],()=>{n.value=!r,setTimeout(()=>{t.scrollIntoView({block:`center`,behavior:`smooth`}),t.focus()},100)}),A(`Previous unseen toot`,[`Ctrl`,`⬅`],()=>je(e)),A(`Previous toot`,[`⬅`],()=>ke(e)),A(`Next toot`,[`➡`],()=>q(e)),A(`Next unseen toot`,[`Ctrl`,`➡`],()=>Ae(e)),function*(){for(let t of te){let n=i[t];for(let r in n)if(n[r]){let n=re[r],i=n.urlFunctions[t](P,e);yield h(`button.open-link`,{onclick:()=>window.open(i)},h(`img.link-icon`,{src:n.icon}),` Open ${ne[t].toLowerCase()} on ${n.name(P)}`)}}},h(`button.follow-toot`,{onclick:()=>{let t=new URL(`./tree.html`,document.location.href);t.hash=new URLSearchParams({url:`https://${P}/@${e.account.acct}/${e.id}`}).toString(),window.open(t)}},`Follow toot`)]},Ne=(e,t)=>n=>{if(!(n.shiftKey||n.altKey||n.metaKey)){switch(n.key){case`ArrowRight`:n.ctrlKey?Ae(e):q(e);break;case`ArrowLeft`:n.ctrlKey?je(e):ke(e);break;case` `:t.value=!t.value;break;default:return}n.preventDefault(),n.stopImmediatePropagation()}},J=document.querySelector(`#toot-tree`),Pe=document.querySelector(`#ancestors`),Y=document.querySelector(`#descendants`);function Fe(e,t){let n=e.findIndex(t);return n<0?{rest:e}:{found:e[n],rest:e.toSpliced(n,1)}}function Ie(e){let t=e.toot.account.id,n=[];for(let r=e;r;){let{found:e,rest:i}=Fe(r.children,e=>e.toot.account.id===t);n.push({toot:r.toot,children:i.map(Ie)}),r=e}return n}function Le(){let{root:e,descendants:t}=R,n=new Map([e,...t].map(e=>[e.id,{toot:e,children:[]}]));for(let r of t){let{in_reply_to_id:t,in_reply_to_account_id:i}=r;if(!t){console.error(`descendant without uplink:`,r);continue}if(!n.has(t)){let r={toot:{is_missing:!0,id:t,in_reply_to_id:e.id,account:{id:i}},children:[]};n.get(e.id).children.push(r),n.set(t,r)}n.get(t).children.push(n.get(r.id))}let r=Ie(n.get(e.id));function*i(e){let t=0;for(let{toot:n,children:r}of e)yield h(`div.node`,`is_missing`in n?Re():G(n,e.length===1?void 0:h(`span.thread-pos`,`${++t}/${e.length}`)),function*(){r.length>0&&(yield h(`ul`,function*(){for(let e of r)yield h(`li`,i(e))}))})}Y.classList.add(`tree-root`),Y.classList.add(`chrono`),d(Y,i(r))}var Re=()=>h(`div.missing-toot`,`toot(s) missing/deleted/inaccessible`);function ze(){let{root:e,descendants:t}=R;d(Y,[e,...t].map(e=>h(`div.node`,G(e))))}var X=p(!0,{name:`display-tree`});function Z(e,...t){m(document.querySelector(e),...t)}function Q(e,...t){d(document.querySelector(e),...t)}function Be(){if(!L)return;let{rootAuthor:e,rootAccountEmojis:n,rootAuthorAvatar:r,rootAcct:i,rootCreatedAt:a,lastCreatedAt:o,lastRetrievalDate:u,nToots:d,nUnseen:f}=L;Q(`#tree-head-name`,e?s(e,n):I),Z(`#tree-head-avatar`,{src:r}),Q(`#tree-head-acct`,i?`@${i} on ${P}`:``),Q(`#tree-head-date-from`,l(a)),Q(`#tree-head-date-to`,l(o)),Q(`#tree-head-date-fetched`,l(u)),Q(`#n-toots`,d?.toFixed()??`??`),Q(`#n-unseen`,f?.toFixed()??`??`),Z(`#all-seen`,{onclick:()=>Oe()}),Z(`#all-unseen`,{onclick:()=>De()}),Z(`#reload`,{onclick:()=>c(P,F)}),Z(`#remove`,{onclick:()=>t(L)}),Z(`#display-tree`,{onchange:e=>X.value=e.currentTarget.checked})}function Ve(){Q(`#toot-id`,F),Q(`#toot-instance`,P),Z(`#follow`,{onclick:()=>c(P,F)}),Pe.replaceChildren(),Y.replaceChildren()}function He(){j(()=>{d(Pe,R.ancestors.map((e,t,n)=>[h(`div.node`,G(e)),X.value&&(n.at(t+1)??R.root).in_reply_to_id!==e.id?h(`div.node`,Re()):void 0]))})}var Ue=Object.entries({following:`you follow`,showing_reblogs:`you get boosts`,notifying:`you get notified about toots`,followed_by:`follows you`,blocking:`you block`,blocked_by:`blocks you`,muting:`you mute`,muting_notifications:`you mute notifications`,requested:`you request to follow`,requested_by:`requests to follow you`,domain_blocking:`you block the domain`,endorsed:`you endorse/feature`});function We({n:e,account:t,relationship:n}){let r=h(`span`,{slot:`label`},{title:`${t.display_name} @${t.acct}`},h(`img`,{src:t.avatar_static}),e>1?e.toString():null);if(n){let e=Ue.flatMap(([e,t])=>n[e]===!0?[`
- `+t]:[]).join(``),t=n.note?.trim();e&&(r.title+=e),t&&(r.title+=`

`+t),(e||t)&&r.classList.add(`indicate-relationship`)}return r}async function Ge(){let e=new Map;for(let t of z){let n=e.get(t.account.acct);n?n.n++:e.set(t.account.acct,{n:1,account:t.account})}let t=[...e.values()];try{let e=t.map(e=>`id[]=${encodeURIComponent(e.account.id)}`).join(`&`),n=await M.get(`accessTokens`,P);if(!n)throw`no access token for `+P;let r=await fetch(`https://${P}/api/v1/accounts/relationships?${e}`,{headers:{Authorization:`Bearer ${n.token}`}});if(!r.ok)throw`HTTPS status: ${r.status} ${r.statusText}`;let i=await r.json(),a=new Map(t.map(e=>[e.account.id,e]));for(let e of i){let t=a.get(e.id);if(!t){console.warn(`Unexpected: no stats for id "${e.id}"`);continue}t.relationship=e}}catch(e){console.warn(`When retrieving relationships:`,e)}t.sort((e,t)=>t.n-e.n),Q(`#n-users`,t.length.toString()),Q(`#user-stats`,t.map(We)),Te.disposeAll(),B.clear();for(let e of z){let t=u(e),n=p(L?.seenIds.has(t)??!1);j(()=>{let e=n.value??!1;if(!L)return;let{seenIds:r}=L;r.has(t)!==e&&(e?r.add(t):r.delete(t),a(L))}),B.set(t,n)}U.clear();for(let e of z){let t=B.get(u(e)),n=m(new O(e),{contextMenuItemProvider:Me,dropDownMenuItemProvider:Me,onseenchange:e=>t.value=e.detail,onkeydown:Ne(e,t),ondblclick:()=>t.value=!t.value});j(()=>{n.seen=t.value}),U.set(e,n)}W.length=0,He(),j(()=>{W.length=R.ancestors.length,X.value?(J.classList.add(`tree`),Le()):(J.classList.remove(`tree`),ze())}),K(R?.root)}async function $(e){if(L=await M.get(`treeOverview`,I),Z(`#app`,{hidden:!L}),Z(`#not-following`,{hidden:!!L}),!L){Ve();return}if(document.title=`${L.rootAuthor}: "${L.teaser}"`,document.querySelector(`link[rel='shortcut icon']`).href=L.rootAuthorAvatar??``,Be(),e){if(R=await M.get(`treeDetails`,I),!R){document.title=L.rootAuthor??`Follow Toot`;return}let{ancestors:e,root:t,descendants:n}=R;z=[...e,t,...n],await Ge()}else{if(!R)return;let{seenIds:e}=L;for(let t of z){let n=u(t),r=B.get(n);r?r.value=e.has(n):console.warn(`Misssing "seen" signal for toot ${n}`)}}}$(!0);